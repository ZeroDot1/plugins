{% if helpers.exists('OPNsense.chrony.general.enabled') and OPNsense.chrony.general.enabled == '1' %}

port {{ OPNsense.chrony.general.port }}
driftfile /var/db/chrony/drift
pidfile /var/run/chrony/chronyd.pid

server {{ OPNsense.chrony.general.peer1 }} iburst
{%   if not helpers.empty('OPNsense.chrony.general.peer2') %}
server {{ OPNsense.chrony.general.peer2 }} iburst
{%   endif %}
{%   if not helpers.empty('OPNsense.chrony.general.peer3') %}
server {{ OPNsense.chrony.general.peer3 }} iburst
{%   endif %}
{%   if helpers.exists('OPNsense.chrony.general.allowednetworks') %}
{%     for network in OPNsense.chrony.general.allowednetworks.split(',') %}
allow {{ network }}
{%     endfor %}
{%   endif %}

{% endif %}
